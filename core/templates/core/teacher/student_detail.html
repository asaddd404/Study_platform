{% extends 'core/base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <h2>Профиль студента: {{ student.username }}</h2>
    <p>Email: {{ student.email }}</p>
    <hr>
    <h3>Прогресс по вашим курсам:</h3>

    <h4 class="mt-4">Прогресс по урокам:</h4>
    {% if progress %}
        <ul class="list-group">
            {% for p in progress %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ p.lesson.title }}</strong>
                    <br>
                    <small class="text-muted">Курс: {{ p.lesson.module.course.title }} / Модуль: {{ p.lesson.module.title }}</small>
                </div>
                {% if p.passed %}
                    <span class="badge bg-success rounded-pill">Завершено</span>
                {% else %}
                    <span class="badge bg-warning rounded-pill">В процессе</span>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>У студента нет прогресса по вашим урокам.</p>
    {% endif %}

    <h4 class="mt-4">Результаты тестов:</h4>
    {% if submissions %}
        <ul class="list-group">
            {% for sub in submissions %}
            <li class="list-group-item">
                <strong>{{ sub.test.title }}</strong> (Модуль: {{ sub.test.module.title }})
                <br>
                Результат: <strong>{{ sub.score }}%</strong>
                <span class="badge {% if sub.passed %}bg-success{% else %}bg-danger{% endif %}">
                    {% if sub.passed %}Сдано{% else %}Не сдано{% endif %}
                </span>
                <br>
                <small class="text-muted">Дата: {{ sub.submitted_at }}</small>
            </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Студент еще не проходил тесты по вашим курсам.</p>
    {% endif %}

    <a href="{% url 'core:profile' %}" class="btn btn-secondary mt-4">Назад</a>
</div>
{% endblock %}