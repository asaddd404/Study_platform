{% extends 'core/base.html' %}
{% load static %}

{% block title %}Прогресс: {{ student.username }} - EduPlatform{% endblock %}

{% block content %}
<div class="course-layout">
    <aside class="course-sidebar">
        <div class="course-sidebar-header">
             <a href="{% url 'core:index' %}" class="logo">...</a>
        </div>
        <nav class="course-sidebar-nav profile-nav">
            <a href="{% url 'core:course' %}">Программа курса</a>
            <a href="{% url 'core:profile' %}" class="active">Мой профиль</a>
            <form action="{% url 'core:logout' %}" method="post">...</form>
        </nav>
    </aside>

    <main class="course-content">
        <a href="{% url 'core:profile' %}#my-students" style="color: var(--color-text-muted); text-decoration: none; margin-bottom: var(--spacing-2); display: inline-block;">
            &larr; К списку учеников
        </a>
        <h1>Прогресс: {{ student.username }}</h1>
        <p style="font-size: 1.125rem; margin-top: calc(var(--spacing-2) * -1); color: var(--color-text-muted);">
            {{ student.email }}
        </p>

        <div class="card" style="margin-bottom: var(--spacing-8);">
            <h2 style="margin-bottom: var(--spacing-6);">Прогресс по урокам (на ваших курсах)</h2>
            {% if progress %}
                <ul class="profile-progress-list">
                    {% for prog in progress %}
                        <li>
                            <div>
                                <span style="font-weight: 500;">{{ prog.lesson.title }}</span>
                                <span style="font-size: 0.875rem; color: var(--color-text-muted); margin-left: var(--spacing-2);"> 
                                    ({{ prog.lesson.module.course.title }} / {{ prog.lesson.module.title }})
                                </span>
                            </div>
                            <span class="profile-progress-status {% if prog.passed %}status-passed{% else %}status-pending{% endif %}">
                                {% if prog.passed %}Пройдено{% else %}Не пройдено{% endif %}
                            </span>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p style="margin-bottom: 0;">У ученика нет прогресса на ваших курсах.</p>
            {% endif %}
        </div>
        
        <div class="card">
            <h2 style="margin-bottom: var(--spacing-6);">Результаты тестов (на ваших курсах)</h2>
             {% if submissions %}
                <ul class="profile-progress-list">
                    {% for sub in submissions %}
                        <li>
                            <div>
                                <span style="font-weight: 500;">{{ sub.test.title }}</span>
                                <span style="font-size: 0.875rem; color: var(--color-text-muted); margin-left: var(--spacing-2);"> 
                                    ({{ sub.test.module.course.title }} / {{ sub.test.module.title }})
                                </span>
                            </div>
                            <span class="profile-progress-status {% if sub.passed %}status-passed{% else %}status-pending{% endif %}">
                                {% if sub.passed %}
                                    Пройден ({{ sub.score }} б.)
                                {% else %}
                                    Не пройден ({{ sub.score }} б.)
                                {% endif %}
                            </span>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p style="margin-bottom: 0;">У ученика нет пройденных тестов на ваших курсах.</p>
            {% endif %}
        </div>
    </main>
</div>
{% endblock %}