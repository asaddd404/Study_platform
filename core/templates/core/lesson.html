{% load static %}
<div class="lesson-content-card" x-data="{ tab: 'description' }">

    {% if lesson.video_url %}
        <div class="lesson-video-wrapper">
            <iframe src="{{ lesson.video_url }}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
    {% endif %}

    <h1>{{ lesson.title }}</h1>

    <div class="tab-buttons">
        <button class="tab-button" @click="tab = 'description'" :class="{ 'active': tab === 'description' }">
            –û–ø–∏—Å–∞–Ω–∏–µ
        </button>
        <button class="tab-button" @click="tab = 'assignment'" :class="{ 'active': tab === 'assignment' }">
            –ó–∞–¥–∞–Ω–∏–µ
        </button>
        <button class="tab-button" @click="tab = 'resources'" :class="{ 'active': tab === 'resources' }">
            –ú–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è
        </button>
    </div>

    <div x-show="tab === 'description'">
        <div class="lesson-prose">
            {{ lesson.content|default:"–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"|safe|linebreaks }}
        </div>
    </div>

    <div x-show="tab === 'assignment'" style="display: none;">
        <div class="lesson-prose">
            {{ lesson.assignment|default:"–ó–∞–¥–∞–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–∑–∂–µ."|safe|linebreaks }}
        </div>
    </div>

    <div x-show="tab === 'resources'" style="display: none;">
        {% if lesson.resources.exists %}
            <ul class="lesson-prose" style="list-style: none; padding-left: 0;">
                {% for resource in lesson.resources.all %}
                    <li>
                        <a href="{% if resource.url %}{{ resource.url }}{% elif resource.file %}{{ resource.file.url }}{% else %}#{% endif %}" target="_blank" class="font-semibold" style="text-decoration: none;">
                            üîó {{ resource.title }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p style="color: var(--color-text-muted); margin-bottom: 0;">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.</p>
        {% endif %}
    </div>

</div>

<script>
    document.dispatchEvent(new CustomEvent('alpine:init'));
</script>