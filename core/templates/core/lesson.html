{% load static %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-4);">
    <h1>{{ lesson.title }}</h1>
    
    {% if progress.passed %}
        <span class="btn btn-success" disabled>Урок пройден</span>
    {% else %}
        <form hx-post="{% url 'core:complete_lesson' lesson.id %}" 
              hx-target="#lesson-main-content">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary">Отметить как пройдено</button>
        </form>
    {% endif %}
</div>
<p class="subtitle" style="margin-top: -10px;">Модуль: {{ lesson.module.title }}</p>

<div class="lesson-video-card">
    {% if lesson.video_url %}
        <div class="video-responsive">
            <iframe src="{{ lesson.video_url }}" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen>
            </iframe>
        </div>
    {% elif lesson.video_file %}
        <video controls style="width: 100%; border-radius: var(--border-radius);">
            <source src="{{ lesson.video_file.url }}" type="video/mp4">
            Ваш браузер не поддерживает тэг video.
        </video>
    {% elif lesson.image_file %}
        <img src="{{ lesson.image_file.url }}" alt="{{ lesson.title }}" style="width: 100%; border-radius: var(--border-radius);">
    {% else %}
        <p>Видео или изображение для этого урока не загружено.</p>
    {% endif %}
</div>

<div class="tab-buttons" style="margin-top: var(--spacing-6);">
    <button class="tab-button active" 
            hx-get="{% url 'core:lesson_description' lesson.id %}" 
            hx-target="#lesson-tab-content"
            hx-swap="innerHTML">
        Описание
    </button>
    <button class="tab-button" 
            hx-get="{% url 'core:lesson_resources' lesson.id %}" 
            hx-target="#lesson-tab-content"
            hx-swap="innerHTML">
        Ресурсы ({{ resources.count }})
    </button>
</div>

<div id="lesson-tab-content" class="lesson-content-card">
    {{ lesson.content|linebreaks }}
</div>